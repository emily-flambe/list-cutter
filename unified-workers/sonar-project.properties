# SonarQube Configuration for Unified Workers
# Comprehensive code quality and security analysis

# Project identification
sonar.projectKey=list-cutter-unified-workers
sonar.projectName=List Cutter Unified Workers
sonar.projectVersion=1.0.0
sonar.organization=list-cutter

# Source code settings
sonar.sources=src
sonar.tests=tests
sonar.sourceEncoding=UTF-8

# Language and file settings
sonar.typescript.node.maxspace=8192
sonar.typescript.inclusions=**/*.ts,**/*.tsx
sonar.typescript.exclusions=**/*.d.ts,**/*.test.ts,**/*.spec.ts,node_modules/**,dist/**

# Test and coverage settings
sonar.typescript.lcov.reportPaths=coverage/lcov.info
sonar.testExecutionReportPaths=test-results/sonar-test-report.xml
sonar.coverage.exclusions=**/*.test.ts,**/*.spec.ts,**/*.d.ts,src/types/**,tests/**,**/*.config.*

# Quality gate thresholds
sonar.qualitygate.wait=true

# Code coverage thresholds
sonar.coverage.overall_line_coverage.required=90
sonar.coverage.overall_branch_coverage.required=85
sonar.coverage.line_coverage.required=90
sonar.coverage.branch_coverage.required=85

# Code duplication thresholds
sonar.cpd.exclusions=**/*.test.ts,**/*.spec.ts
sonar.duplication.block.size=10
sonar.duplication.threshold=3

# Security analysis
sonar.security.hotspots.inheritFromParent=true
sonar.security.hotspots.disabled=false

# Maintainability thresholds
sonar.maintainability.rating=A
sonar.sqale.rating=A
sonar.technical_debt.threshold=5%

# Reliability thresholds
sonar.reliability.rating=A
sonar.bugs.threshold=0

# Security thresholds
sonar.security.rating=A
sonar.vulnerabilities.threshold=0
sonar.security_hotspots.threshold=0

# Code smells thresholds
sonar.code_smells.threshold=10

# Complexity analysis
sonar.complexity.threshold=10
sonar.complexity.functions=10
sonar.complexity.files=20

# Issue exclusions for specific patterns
sonar.issue.ignore.multicriteria=e1,e2,e3,e4,e5

# Exclude test files from certain rules
sonar.issue.ignore.multicriteria.e1.ruleKey=typescript:S*
sonar.issue.ignore.multicriteria.e1.resourceKey=**/*.test.ts

# Exclude configuration files from complexity rules
sonar.issue.ignore.multicriteria.e2.ruleKey=typescript:S3776
sonar.issue.ignore.multicriteria.e2.resourceKey=**/*.config.*

# Exclude type definition files
sonar.issue.ignore.multicriteria.e3.ruleKey=*
sonar.issue.ignore.multicriteria.e3.resourceKey=**/*.d.ts

# Exclude generated files
sonar.issue.ignore.multicriteria.e4.ruleKey=*
sonar.issue.ignore.multicriteria.e4.resourceKey=**/dist/**

# Exclude vendor/node_modules
sonar.issue.ignore.multicriteria.e5.ruleKey=*
sonar.issue.ignore.multicriteria.e5.resourceKey=**/node_modules/**

# Custom rules for TypeScript
sonar.typescript.tsconfigPath=tsconfig.json

# Build breaker settings - fail build on quality gate failure
sonar.buildbreaker.skip=false
sonar.buildbreaker.queryMaxAttempts=30
sonar.buildbreaker.queryInterval=10000

# Analysis parameters
sonar.analysis.buildNumber=${BUILD_NUMBER}
sonar.analysis.repository=${GIT_REPOSITORY}
sonar.analysis.sha1=${GIT_COMMIT}
sonar.analysis.prNumber=${PULL_REQUEST_NUMBER}

# Branch analysis
sonar.branch.name=${BRANCH_NAME}
sonar.branch.target=main

# Pull request analysis
sonar.pullrequest.key=${PULL_REQUEST_NUMBER}
sonar.pullrequest.branch=${PULL_REQUEST_BRANCH}
sonar.pullrequest.base=${PULL_REQUEST_BASE}

# Working directory
sonar.working.directory=.sonarqube

# Logging
sonar.log.level=INFO
sonar.verbose=false

# Performance tuning
sonar.host.url=${SONAR_HOST_URL}
sonar.login=${SONAR_TOKEN}

# Scanner settings
sonar.scanner.metadataFilePath=.sonarqube/report-task.txt

# Custom metrics for Cloudflare Workers
# These are additional properties for specialized analysis

# Workers-specific file patterns
sonar.typescript.workers.inclusions=src/**/*.ts
sonar.typescript.workers.exclusions=src/**/*.test.ts,src/**/*.spec.ts

# Performance analysis for Workers
sonar.workers.bundle.size.threshold=1048576
sonar.workers.execution.time.threshold=30000
sonar.workers.memory.threshold=134217728

# Security analysis for Workers
sonar.workers.security.headers.required=true
sonar.workers.security.cors.validation=true
sonar.workers.security.csp.validation=true

# Business logic analysis
sonar.csv.processing.validation=true
sonar.file.upload.security=true
sonar.auth.security.validation=true

# API analysis
sonar.api.documentation.required=true
sonar.api.versioning.required=true
sonar.api.rate.limiting.required=true

# Database analysis
sonar.database.query.optimization=true
sonar.database.connection.management=true
sonar.database.security.validation=true