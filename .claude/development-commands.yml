# Essential Development Commands
# Project-specific commands and workflows

PreCommitValidation: &PreCommitValidation
  automation: "Automated via husky pre-commit hook (.husky/pre-commit)"
  automated_checks:
    wrangler_version_check: "npx wrangler --version # Must be 4.0.0+"
    type_checking: "npx tsc --noEmit"
    essential_build_check: "npm run build"
  
  manual_deployment_checks:
    directory: "cd cloudflare/workers"
    commands:
      - "npx wrangler versions upload --dry-run"
      - "npx wrangler deploy --dry-run"

TroubleshootingCommands: &TroubleshootingCommands
  clean_environment_test:
    description: "matches CI"
    commands:
      - "rm -rf node_modules package-lock.json"
      - "npm ci"
  
  wrangler_version_validation:
    description: "Ensure Wrangler v4+ is installed"
    commands:
      - "npx wrangler --version"
      - "# Should show version 4.0.0 or higher"
      - "# If version is below 4.0.0, run: npm install wrangler@latest"
  
  wrangler_configuration_check:
    - "npx wrangler whoami"
    - "npx wrangler --version"
    - "npx wrangler d1 list"
  
  typescript_configuration_testing:
    - "npx tsc --showConfig"
    - "npx tsc --noEmit --incremental false"

BuildSuccessCriteria: &BuildSuccessCriteria
  requirements:
    - "npm run build completes successfully"
    - "npx wrangler versions upload --dry-run passes"
    - "Bundle size is reasonable (< 200kb typical)"
    - "No critical runtime errors in essential flows"
  
  note: "TypeScript strict checking is secondary to functional builds. Focus on build success and runtime safety over perfect type compliance."